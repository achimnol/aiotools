Use weak key dict to prevent memroy leak when storing task states by task scopes
